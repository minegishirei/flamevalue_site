{% extends 'fanstatic/dashboard/top/base/base.html' %}


{% block mainblock %}



<!-- Content Wrapper -->
<div id="content-wrapper" class="d-flex flex-column">

    <!-- Main Content -->
    <div id="content">

        {% include 'fanstatic/dashboard/base/topbar.html' %}



        <!-- Begin Page Content -->
        <div class="container-fluid">


            <!-- Page Heading -->
            <h1 class="h3 mb-2 text-gray-800">コミュニティ分析サイト</h1>
            <p class="mb-4">
                このウェブサイトはtwitterの検索結果から検索ワードのコミュニティを統計的に分析するツールです。</p>


            <!-- Content Row -->
            <div class="row">

                <!-- Earnings (Monthly) Card Example -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-primary shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                        更新頻度</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800">毎日更新</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                </div>
                            </div>
                            データは一日に一度の割合で更新されます。
                        </div>
                    </div>
                </div>

                <!-- Earnings (Monthly) Card Example -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-success shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                        データ母数</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800">50以上</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                                </div>
                            </div>
                            twitterのAPIを利用します。
                        </div>
                    </div>
                </div>

                <!-- Earnings (Monthly) Card Example -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-info shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                        サイトの完成度
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">60%</div>
                                        </div>
                                        <div class="col">
                                            <div class="progress progress-sm mr-2">
                                                <div class="progress-bar bg-info" role="progressbar" style="width: 60%"
                                                    aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                        </div>
                                    </div>
                                    機能の追加も予定
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Pending Requests Card Example -->
                <div class="col-xl-3 col-md-6 mb-4">
                    <div class="card border-left-warning shadow h-100 py-2">
                        <div class="card-body">
                            <div class="row no-gutters align-items-center">
                                <div class="col mr-2">
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                        Pending Requests</div>
                                    <div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
                                </div>
                                <div class="col-auto">
                                    <i class="fas fa-comments fa-2x text-gray-300"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>




            <!-- Content Row -->
            <div class="row">

                <div class="col-lg-6 mb-4">

                    <!-- Illustrations -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">
                                2021/06/29 -「欲」の割合カードを追加しました。
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="text-center">
                                <iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0"
                                    scrolling="no" frameborder="0"
                                    src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=08067324417-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4414300088&linkId=a266e4201298f9442368592784e77633&bc1=000000&amp;lt1=_blank&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr">
                                </iframe>
                            </div>
                            <p>
                                新しい割合カードを追加しました。
                                その名も「欲」カード。
                                著作「twitterの心理学」を参考にしており、
                                twitterで最も使用されている漢字は「欲」が最多であることからカードに追加。
                                この漢字を含んでいる場合はユーザーが何かしらの要求を満たそうと動いていることがわかります。
                                特に、「知って欲しい」「友達が欲しい」などが多い傾向にあるそうです。
                            </p>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Content Row -->
            <div class="row">

                <div class="col-lg-6 mb-4">

                    <!-- Illustrations -->
                    <div class="card shadow mb-4">
                        <div class="card-header py-3">
                            <h6 class="m-0 font-weight-bold text-primary">サイト概要</h6>
                        </div>
                        <div class="card-body">
                            <div class="text-center">

                                <iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0"
                                    scrolling="no" frameborder="0"
                                    src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=08067324417-22&m=amazon&o=9&p=8&l=as1&IS2=1&detail=1&asins=4414300088&linkId=a266e4201298f9442368592784e77633&bc1=000000&amp;lt1=_blank&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr">
                                </iframe>
                            </div>
                            <p>
                                本サイトは、アニメ、漫画などのコミュニティを研究する目的で立ち上げられました。
                                そのために、あるコミュニティ内の、アカウントの年齢、フォロワー数とフォロー数の関係
                                アカウントの説明文などに着目し、統計データを収集します。
                                また、本サイトはツイッターの心理学の影響を受けております。
                                SNSによって作り出されるコミュニティの研究などにご活用ください。
                                リクエスト等あればこちらまで<a target="_blank" rel="nofollow"
                                    href="https://twitter.com/se_maintain">@se_maintain</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>


        </div>
        <!-- /.container-fluid -->

    </div>
    <!-- End of Main Content -->

    {% endblock %}

    {% block scriptblock %}



    <script>
        url = "https://raw.githubusercontent.com/kawadasatoshi/{{ repo }}/main/{{ htmlname }}"

        htmlname = "{{ htmlname }}"
        console.log("here")
        var jsonDate = []
        $.getJSON(url, (data) => {
            jsonDate = data
            userData = []
            retweetData = []
            console.log("here2")
            name_list = []
            friends_count_list = new Array();
            followers_count_list = new Array();
            damy_list = []

            create_year_list = []

            mother_num = 0
            interest_fun_num = 0
            for (var row in jsonDate) {
                mother_num++;
                damy_list.push(".")
                userData.push(jsonDate[row].user)
                user = jsonDate[row].user
                console.log(user)
                name_list.push(user.name)
                friends_count_list.push(user.friends_count)
                followers_count_list.push(user.followers_count)

                if (user.description.match(htmlname)) {
                    interest_fun_num++;
                }
                create_year_list.push(user.created_at.substring(25, 30))
            }
            console.log(name_list)
            friends_count_list.sort(function (first, second) {
                if (first > second) {
                    return 1;
                } else if (first < second) {
                    return -1;
                } else {
                    return 0;
                }
            });

            followers_count_list.sort(function (first, second) {
                if (first > second) {
                    return 1;
                } else if (first < second) {
                    return -1;
                } else {
                    return 0;
                }
            });

            create_year_list.sort(function (first, second) {
                if (first > second) {
                    return 1;
                } else if (first < second) {
                    return -1;
                } else {
                    return 0;
                }
            });

            non_dub_year_list = Array.from(new Set(create_year_list))
            year_count_list = []
            for (var i in non_dub_year_list) {
                year1 = non_dub_year_list[i]
                count = 0
                for (var j in create_year_list) {
                    year2 = create_year_list[j]
                    if (year1 == year2) {
                        count++;
                    }
                }
                year_count_list.push(count);
            }

            //friends_count_list = friends_count_list.reverse();
            console.log("frends_count_list", friends_count_list)

            applyPieChart("myInterestPieChart", ["熱狂的", "普通"], [interest_fun_num, mother_num - interest_fun_num], ['#4e73df', '#1cc88a'], ['#2e59d9', '#17a673'])
            //applyBarChart("myFollowerBarChart", damy_list, followers_count_list, "人", "フォロワー数")
            //applyBarChart("myBarChart", damy_list, friends_count_list, "人", "フォロー数")

            console.log("non_dub_year_list", non_dub_year_list)
            console.log("year_count_list", year_count_list)
            applyAreaChart("myAcountYearAreaChart", non_dub_year_list, year_count_list, "アカウント誕生年", "人")
        })
    </script>

    {% endblock %}